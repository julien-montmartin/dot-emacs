<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="fr" xml:lang="fr">
<head>
<!-- 2019-10-13 dim. 23:56 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Une Configuration Emacs</title>
<meta name="generator" content="Org mode" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="css/org.css"/>
<style type="text/css">
/*Tdm sur 3 colonnes*/
#text-table-of-contents {
padding: 1em;
column-count: 3;
column-gap: 1em;
}
/*Corrige le pb des liens qui sautent dans la tdm*/
#text-table-of-contents a {
border-bottom: 1px dotted;
border-bottom-color: transparent;
}
#text-table-of-contents a:hover {
border-bottom-color: #035;
}
</style>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2018 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">Une Configuration Emacs</h1>
<div class="ABSTRACT">
<p>
Voici ma configuration Emacs - un chantier jamais fini - au 13/10/2019. Cette configuration prend la forme d'un <a href="https://github.com/julien-montmartin/dot-emacs/blob/master/emacs.org">fichier Org</a>, à partir duquel sont générés une <a href="emacs.html">documentation HTML</a>, ainsi que le <a href="emacs.el">fichier Lisp</a> qui constituait auparavant mon <code>.emacs</code>. Ce dernier s'est transformé en un petit <a href="loader.el">fichier de chargement</a>, qui valorise quelques raccourcis (et autres détails spécifiques au poste sur lequel il se trouve) avant de charger le Lisp généré.
</p>

<p>
C'est également un essai pour voir ce qu'on peut faire avec <a href="http://orgmode.org/">Org</a>. Ce fichier n'a pas fini de se transformer, et peut-être retournera-t-il à sa forme originelle, à savoir un simple fichier Lisp. Un attendant, un grand merci à <a href="http://gongzhitaao.org/orgcss">Zhitao Gong</a> pour le CSS qui habille les exports HTML.
</p>

</div>

<div id="table-of-contents">
<h2>Table des matières</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orga17e445">À propos du temps</a></li>
<li><a href="#orgd474617">Généralités</a></li>
<li><a href="#org20e0f95">Raccourcis Fn</a></li>
<li><a href="#orgaa0c5ee">Require</a></li>
<li><a href="#org61a5e08">Navigation dans les buffers</a></li>
<li><a href="#org6b3b3e5">Compilation</a></li>
<li><a href="#org6137d61">Copier/coller</a></li>
<li><a href="#org59a62d7">Parenthèses et Cie</a></li>
<li><a href="#orge0baf3c">Suggestions</a></li>
<li><a href="#orga6c5f60">Mise à jour du path</a></li>
<li><a href="#orgacc9b22">Valorisation du proxy</a></li>
<li><a href="#orge8eeded">Ajustements à l'OS</a>
<ul>
<li><a href="#org3d167ea">Sous Linux</a></li>
<li><a href="#orge5b276f">Sous Mac</a></li>
</ul>
</li>
<li><a href="#org4f46ae5">Gestionnaire de paquets</a></li>
<li><a href="#orgf87292e">Thème Leuven</a></li>
<li><a href="#orgb55890c">TabTab minor mode</a></li>
<li><a href="#org38d795a">Auto Complete</a>
<ul>
<li><a href="#orgae9c15d">Recherche approximative</a></li>
<li><a href="#orgfdbb98a">Intégration à Helm</a></li>
<li><a href="#orgfcca676">Source pour completion-at-point</a></li>
</ul>
</li>
<li><a href="#orgd9b435d">Bookmarks</a></li>
<li><a href="#org61cbd29">C &amp; C++</a>
<ul>
<li><a href="#org6795a6a">Global</a></li>
</ul>
</li>
<li><a href="#orgca687e0">Column Marker</a></li>
<li><a href="#org6abb81e">CMake</a></li>
<li><a href="#org25c614d">DTrace</a></li>
<li><a href="#org304f9ab">EasyPG Assistant</a></li>
<li><a href="#org2b200fe">Ediff</a></li>
<li><a href="#orgbd3b6fa">Find File At Point</a></li>
<li><a href="#org8b89af6">Fill column indicator</a></li>
<li><a href="#orgfa09730">Graphviz</a></li>
<li><a href="#org11d3e0d">Helm</a></li>
<li><a href="#org95f6cbb">Htmlize</a></li>
<li><a href="#org96d8395">Idle HighLight Mode</a></li>
<li><a href="#orga88ed85">Emacs Lisp</a></li>
<li><a href="#org7032d0b">Magit</a></li>
<li><a href="#org60e5373">MMM Mode</a></li>
<li><a href="#org717cad9">Org</a>
<ul>
<li><a href="#org3e11a11">Mise à jour</a></li>
</ul>
</li>
<li><a href="#org8e0bfae">Perforce</a></li>
<li><a href="#orgd9dfcbf">Prettify Symbols</a></li>
<li><a href="#org7e7c72d">Projectile</a></li>
<li><a href="#orge0b9512">Qt</a></li>
<li><a href="#org7b72898">Rainbow delimiters</a></li>
<li><a href="#org1527435">Rainbow mode</a></li>
<li><a href="#org624f9c8">Related</a></li>
<li><a href="#orgb5ae57b">Rust</a></li>
<li><a href="#orgb0cd68c">Shell scripts</a></li>
<li><a href="#org3146b03">Souris</a></li>
<li><a href="#orgf7fad86">Tcl</a></li>
<li><a href="#org63f602b">Tramp</a></li>
<li><a href="#orgb9ef341">Unfill</a></li>
<li><a href="#org908a7ac">Unicode et UTF-8</a></li>
<li><a href="#orgc5bd121">Uniquify</a></li>
<li><a href="#org3098d71">Whitespace</a></li>
<li><a href="#org8a05bb8">XML</a></li>
<li><a href="#orge3d39e8">Installation automatique</a></li>
</ul>
</div>
</div>

<div id="outline-container-orga17e445" class="outline-2">
<h2 id="orga17e445">À propos du temps</h2>
<div class="outline-text-2" id="text-orga17e445">
<p>
La fonction <code>last-step-duration</code>, appelée régulièrement, permet de voir comment le temps s'écoule lors du chargement du <code>.emacs</code>. À chaque appel, elle laisse une trace dans le buffer <code>*Messages*</code> avec le temps écoulé depuis l'appel précédent, ainsi que le temps total écoulé depuis le début du chargement du fichier. Certainement pas un modèle de Lisp, mais remplit son office et aide à comprendre pourquoi Emacs est parfois lent à démarrer.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">reset-ts</span><span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">setq</span> first-ts <span class="org-rainbow-delimiters-depth-3">(</span>current-time<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">setq</span> last-ts first-ts<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">step-duration</span><span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">let*</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>ts <span class="org-rainbow-delimiters-depth-5">(</span>current-time<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
         <span class="org-rainbow-delimiters-depth-4">(</span>elapsed <span class="org-rainbow-delimiters-depth-5">(</span>float-time <span class="org-rainbow-delimiters-depth-6">(</span>time-subtract ts last-ts<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">setq</span> last-ts ts<span class="org-rainbow-delimiters-depth-3">)</span>
    elapsed<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">total-duration</span><span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">let*</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>ts <span class="org-rainbow-delimiters-depth-5">(</span>current-time<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
         <span class="org-rainbow-delimiters-depth-4">(</span>elapsed <span class="org-rainbow-delimiters-depth-5">(</span>float-time <span class="org-rainbow-delimiters-depth-6">(</span>time-subtract ts first-ts<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
    elapsed<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">last-step-duration</span><span class="org-rainbow-delimiters-depth-2">(</span>title<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>message <span class="org-string">"&#932;=%.3fs\t&#916;=%.3fs\t%s"</span> <span class="org-rainbow-delimiters-depth-3">(</span>total-duration<span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-3">(</span>step-duration<span class="org-rainbow-delimiters-depth-3">)</span> title<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>reset-ts<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Ce code apparait en début de fichier afin d'initialiser une variable globale contenant le <i>time stamp</i> de début de chargement de ce <code>.emacs</code>. Bien que ses appels ne soient pas exportés dans le HTML généré, la fonction <code>last-step-duration</code> est utilisée régulièrement, à la fin de chaque section. Exemple de trace :
</p>

<pre class="example">
Τ=2.516s	Δ=0.016s	Rainbow delimiters
</pre>
</div>
</div>

<div id="outline-container-orgd474617" class="outline-2">
<h2 id="orgd474617">Généralités</h2>
<div class="outline-text-2" id="text-orgd474617">
<p>
Désactive l'écran d'accueil, Emacs s'ouvre avec le buffer <code>scratch</code>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> inhibit-startup-screen t<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Affichage du nom du buffer dans la barre de titre
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> frame-title-format '<span class="org-rainbow-delimiters-depth-2">(</span>buffer-file-name <span class="org-string">"Emacs: %b (%f)"</span> <span class="org-string">"Emacs: %b"</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Dans le terminal, pas de barre de menu
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">unless</span> window-system <span class="org-rainbow-delimiters-depth-2">(</span>menu-bar-mode -1<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
En mode graphique, cache la barre d'outils
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">when</span> window-system <span class="org-rainbow-delimiters-depth-2">(</span>tool-bar-mode -1<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
En mode graphique, gouttière réduite et à gauche uniquement (nil pour remettre la taille par défaut). Cohabite mal avec <code>fill-column-mode</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">when</span> window-system <span class="org-rainbow-delimiters-depth-2">(</span>set-fringe-mode '<span class="org-rainbow-delimiters-depth-3">(</span>4 . 0<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
En mode graphique, barre de défilement à droite (-1 pour désactiver)
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">when</span> window-system <span class="org-rainbow-delimiters-depth-2">(</span>set-scroll-bar-mode 'right<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Un buffer pour lequel Emacs n'a attribué aucun mode majeur s'ouvre en mode texte.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq-default</span> major-mode 'text-mode<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Une ligne de 80 caractères est suffisamment longue. La variable <code>default-fill-column</code> affecte de nombreuses commandes comme <code>fill-paragraph</code>, ainsi que des modes mineurs comme <code>whitespace-mode</code>. Pour ceux qui le souhaitent, appliquer la règle des 80 colonnes commence par là.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> default-fill-column 80<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Indentation avec des tabulations de 4 caractères
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq-default</span> c-basic-offset 4
              tab-width 4
              indent-tabs-mode t<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
En fin de buffer, les touches flèches ne créent pas une nouvelle ligne
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq-default</span> next-line-add-newlines nil<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Affichage de la ligne et de la colonne du curseur dans la mode line
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>line-number-mode t<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>column-number-mode t<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Pour utiliser <code>narrow-to-region</code> via son raccourci clavier <kbd>C</kbd>-<kbd>n</kbd> <kbd>n</kbd>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>put 'narrow-to-region 'disabled nil<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Désactive la transient mark. La région est toujours active, mais pas surlignée. Au besoin, la transient mark est activée le temps d'une commande avec <kbd>C</kbd>-<kbd>SPC</kbd> <kbd>C</kbd>-<kbd>SPC</kbd>. Correspond à l'ancien comportement d'Emacs.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> transient-mark-mode nil<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Dans un environnement graphique, lance Emacs en mode serveur
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">when</span> window-system <span class="org-rainbow-delimiters-depth-2">(</span>server-start<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Des modules peuvent se trouver dans <code>site-lisp</code>. On ajoute ce répertoire à la variable <code>load-path</code> afin qu'ils soient trouvés par la commande <code>require</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>add-to-list 'load-path <span class="org-string">"~/.emacs.d/site-lisp/"</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Place les <i>backups</i> (copie d'un fichier avant modifications) et les sauvegardes automatiques (faites périodiquement pendant qu'on édite un fichier) dans un répertoire temporaire, selon la plateforme :
</p>

<ul class="org-ul">
<li>sur Mac : <code>/var/folders/xxx</code></li>
<li>sur Windows : <code>c:/Users/yyy/AppData/Local/Temp</code></li>
<li>sur Linux : <code>/tmp</code></li>
</ul>

<p>
L'expression régulière <code>".*"</code> ci-après indique que la règle concerne tous les fichiers, car on peut faire, par exemple, des règles différentes selon l'extension.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> backup-directory-alist `<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-rainbow-delimiters-depth-3">(</span><span class="org-string">".*"</span> . ,temporary-file-directory<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> auto-save-file-name-transforms `<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-rainbow-delimiters-depth-3">(</span><span class="org-string">".*"</span> ,temporary-file-directory t<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Mise en évidence de la ligne en cours dans Dired
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>add-hook 'dired-mode-hook 'hl-line-mode<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Sur Mac, Dired utilise GNU <code>ls</code> si disponible
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">when</span> <span class="org-rainbow-delimiters-depth-2">(</span>eq system-type 'darwin<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-3">(</span>file-executable-p <span class="org-string">"/usr/local/bin/gls"</span><span class="org-rainbow-delimiters-depth-3">)</span>
      <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">setq</span> insert-directory-program <span class="org-string">"/usr/local/bin/gls"</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Common Lisp, pour <code>ignore-errors</code> et d'autres
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">require</span> '<span class="org-constant">cl</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org20e0f95" class="outline-2">
<h2 id="org20e0f95">Raccourcis Fn</h2>
<div class="outline-text-2" id="text-org20e0f95">
<p>
Quelques raccourcis pratiquent sur les touches fonctions, certains inspirés de Visual Studio ou de Xcode. Lorsqu'il est lancé en mode texte depuis un terminal, Emacs ne voit pas les raccourcis en <kbd>C</kbd>-<kbd>Fn</kbd>. Pour cette raison, ils sont en général doublés sur <kbd>S</kbd>-<kbd>Fn</kbd>.
</p>

<ul class="org-ul">
<li><kbd>F1</kbd> pour <code>view-mode</code>, qui permet de passer un buffer qu'on ne veut pas modifier en lecture seule</li>
<li><kbd>C</kbd>-<kbd>F1</kbd> pour <code>revert-buffer</code>, qui permet de revenir à la dernière version sauvegardée du fichier</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">&#192; la place de view-order-manuals qui est normalement sur f1</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"&lt;f1&gt;"</span><span class="org-rainbow-delimiters-depth-2">)</span>    'view-mode<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"C-&lt;f1&gt;"</span><span class="org-rainbow-delimiters-depth-2">)</span>  'revert-buffer<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"S-&lt;f1&gt;"</span><span class="org-rainbow-delimiters-depth-2">)</span>  'revert-buffer<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<ul class="org-ul">
<li><kbd>F2</kbd> pour <code>bm-toggle</code>, qui insère (ou retire) un marque-page sur la ligne. La ligne marquée est alors surlignée</li>
<li><kbd>C</kbd>-<kbd>F2</kbd> et <kbd>S</kbd>-<kbd>F2</kbd> pour <code>bm-next</code> et <code>bm-previous</code>, qui permettent de parcourir les marques-pages</li>
</ul>

<p>
En mode terminal <kbd>C</kbd>-<kbd>f2</kbd> ne fonctionne pas, et parcourir les marques-pages avec Helm via <kbd>C</kbd>-<kbd>F2</kbd> est plus pratique. Dans tous les cas, <code>helm-bm</code> est disponible via <kbd>C</kbd>-<kbd>c</kbd> <kbd>b</kbd>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"&lt;f2&gt;"</span><span class="org-rainbow-delimiters-depth-2">)</span>    'bm-toggle<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"C-&lt;f2&gt;"</span><span class="org-rainbow-delimiters-depth-2">)</span>  'bm-next<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"S-&lt;f2&gt;"</span><span class="org-rainbow-delimiters-depth-2">)</span>  'bm-previous<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">unless</span> window-system
  <span class="org-rainbow-delimiters-depth-2">(</span>global-set-key <span class="org-rainbow-delimiters-depth-3">(</span>kbd <span class="org-string">"S-&lt;f2&gt;"</span><span class="org-rainbow-delimiters-depth-3">)</span>    'helm-bm<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<ul class="org-ul">
<li><kbd>F3</kbd> pour <code>hl-line-mode</code>, bien pratique quand on a besoin de se concentrer sur une ligne, ou lorsqu'on doit traiter un buffer une ligne après l'autre.</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"&lt;f3&gt;"</span><span class="org-rainbow-delimiters-depth-2">)</span>    'hl-line-mode<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<ul class="org-ul">
<li><kbd>F4</kbd> pour <code>projectile-grep</code> (ou <code>helm-projectile-grep</code> si Helm est activé). Si Projectile est disponible pour un projet, permet de chercher interactivement dans les fichiers de ce projet. Vraiment très utile ! Fonctionne particulièrement bien avec <kbd>C</kbd>-<kbd>c</kbd> <kbd>h</kbd> <kbd>b</kbd>, qui comme toujours avec Helm, permet de ramener les dernières propositions&#x2026;</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"&lt;f4&gt;"</span><span class="org-rainbow-delimiters-depth-2">)</span>    'projectile-grep<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<ul class="org-ul">
<li><kbd>F5</kbd> pour <code>run-compilation</code>, fonction perso qui sauvegarde l'agencement des buffers affichés avant de lancer une compilation</li>
<li><kbd>C</kbd>-<kbd>F5</kbd> pour <code>end-compilation</code>, qui met fin à une session de compilation et restaure l'affichage</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"&lt;f5&gt;"</span><span class="org-rainbow-delimiters-depth-2">)</span>    'run-compilation<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"C-&lt;f5&gt;"</span><span class="org-rainbow-delimiters-depth-2">)</span>  'end-compilation<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"S-&lt;f5&gt;"</span><span class="org-rainbow-delimiters-depth-2">)</span>  'end-compilation<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<ul class="org-ul">
<li><kbd>F6</kbd> pour <code>projectile-multi-occur</code>, qui lance <code>occur</code> dans tous les buffers ouverts appartenant au projet du buffer courant</li>
<li><kbd>C</kbd>-<kbd>F6</kbd> pour <code>helm-occur</code>, qui lance une version interactive depuis Helm de <code>occur</code> : La liste des correspondances est construite dynamiquement lors de la frappe, et à tout moment <kbd>↑</kbd> et <kbd>↓</kbd> permettent d'en sélectionner une, pour laquelle <kbd>TAB</kbd> donnera un aperçu.</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"&lt;f6&gt;"</span><span class="org-rainbow-delimiters-depth-2">)</span>    'projectile-multi-occur<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"C-&lt;f6&gt;"</span><span class="org-rainbow-delimiters-depth-2">)</span>  'helm-occur<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"S-&lt;f6&gt;"</span><span class="org-rainbow-delimiters-depth-2">)</span>  'helm-occur<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<ul class="org-ul">
<li><kbd>F8</kbd> pour <a href="#org8b89af6">Fill column indicator</a>, qui met en évidence la colonne 80 dans les modes de développement.</li>
<li><kbd>C</kbd>-<kbd>F8</kbd> pour désactiver (ou réactiver) <a href="#org3098d71">Whitespace</a> lorsqu'il devient trop intrusif, en particulier avec les lignes trop longues.</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"&lt;f8&gt;"</span><span class="org-rainbow-delimiters-depth-2">)</span>    'fci-mode<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"C-&lt;f8&gt;"</span><span class="org-rainbow-delimiters-depth-2">)</span>  'whitespace-mode<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"S-&lt;f8&gt;"</span><span class="org-rainbow-delimiters-depth-2">)</span>  'whitespace-mode<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgaa0c5ee" class="outline-2">
<h2 id="orgaa0c5ee">Require</h2>
<div class="outline-text-2" id="text-orgaa0c5ee">
<p>
Un wrapper pour <code>require</code>, qui n'empêche pas le chargement du <code>.emacs</code> lorsqu'un module n'est pas disponible, et génère des traces dans <code>*Messages*</code>, avec en cas de succès, le temps passé par Emacs pour charger le module.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">my-require</span><span class="org-rainbow-delimiters-depth-2">(</span>feature<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">condition-case</span> nil
      <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">let</span> <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-rainbow-delimiters-depth-5">(</span>ts <span class="org-rainbow-delimiters-depth-6">(</span>current-time<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
        <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-keyword">progn</span>
          <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-keyword">require</span> <span class="org-constant">feature</span><span class="org-rainbow-delimiters-depth-5">)</span>
          <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-keyword">let</span> <span class="org-rainbow-delimiters-depth-6">(</span><span class="org-rainbow-delimiters-depth-7">(</span>elapsed <span class="org-rainbow-delimiters-depth-8">(</span>float-time <span class="org-rainbow-delimiters-depth-9">(</span>time-subtract <span class="org-rainbow-delimiters-depth-1">(</span>current-time<span class="org-rainbow-delimiters-depth-1">)</span> ts<span class="org-rainbow-delimiters-depth-9">)</span><span class="org-rainbow-delimiters-depth-8">)</span><span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span>
            <span class="org-rainbow-delimiters-depth-6">(</span>message <span class="org-string">"Successfully load '%s' in %.3fs"</span> feature elapsed<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>file-error
     <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-keyword">progn</span> <span class="org-rainbow-delimiters-depth-5">(</span>message <span class="org-string">"Fail to load required feature '%s'"</span> feature<span class="org-rainbow-delimiters-depth-5">)</span> nil<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Il s'utilise ainsi :
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">when</span> <span class="org-rainbow-delimiters-depth-2">(</span>my-require 'package-xxx<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>message <span class="org-string">"Do foo"</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>message <span class="org-string">"Do bar"</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>message <span class="org-string">"Do baz"</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
<code>my-require</code> est largement utilisé dans la suite de ce fichier, mais afin de ne pas avoir partout un niveau d'indentation, le <code>when</code> est sous-entendu, et n'est pas exporté dans le HTML. Le code apparait donc ainsi :
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>my-require 'package-xxx<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>message <span class="org-string">"Do foo"</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>message <span class="org-string">"Do bar"</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>message <span class="org-string">"Do baz"</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
C'est-à-dire comme avec un <code>require</code> classique. Exemple de traces :
</p>

<pre class="example">
Fail to load required feature ’p4’
Successfully load ’rainbow-mode’ in 0.031s
</pre>

<p>
On peut aussi utiliser le <i>soft require</i>, qui ne génère pas d'erreur quand le module n'est pas trouvé :
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">require</span> '<span class="org-constant">package-foobar</span> nil t<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org61a5e08" class="outline-2">
<h2 id="org61a5e08">Navigation dans les buffers</h2>
<div class="outline-text-2" id="text-org61a5e08">
<p>
Lorsqu'on navigue dans les buffers, on préfère sauter les buffers ouverts automatiquement par Dired, Helm, ou autre, comme <code>*compilation*</code> par exemple. On définit pour cela la fonction <code>navigate-nostar-buffer</code>, qui cherche le prochain buffer ne commençant pas par <code>*</code> (ou le précédent si appelé avec un argument).
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">navigate-nostar-buffer</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-type">&amp;optional</span> previous<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-doc">"Navigate to next \"no star\" buffer, or previous one if PREVIOUS is t."</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">let</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>start-buffer <span class="org-rainbow-delimiters-depth-5">(</span>buffer-name<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">cl-flet</span> <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-rainbow-delimiters-depth-5">(</span>next-f <span class="org-rainbow-delimiters-depth-6">()</span> <span class="org-rainbow-delimiters-depth-6">(</span><span class="org-keyword">if</span> previous <span class="org-rainbow-delimiters-depth-7">(</span>next-buffer<span class="org-rainbow-delimiters-depth-7">)</span> <span class="org-rainbow-delimiters-depth-7">(</span>previous-buffer<span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
      <span class="org-rainbow-delimiters-depth-4">(</span>next-f<span class="org-rainbow-delimiters-depth-4">)</span>
      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-keyword">while</span>
          <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-keyword">and</span> <span class="org-rainbow-delimiters-depth-6">(</span>string-match-p <span class="org-string">"^</span><span class="org-string"><span class="org-warning">\</span></span><span class="org-string">*"</span> <span class="org-rainbow-delimiters-depth-7">(</span>buffer-name<span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span>
               <span class="org-rainbow-delimiters-depth-6">(</span>not <span class="org-rainbow-delimiters-depth-7">(</span>equal start-buffer <span class="org-rainbow-delimiters-depth-8">(</span>buffer-name<span class="org-rainbow-delimiters-depth-8">)</span><span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span>
        <span class="org-rainbow-delimiters-depth-5">(</span>next-f<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">navigate-next-nostar-buffer</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-doc">"Navigate to next \"no star\" buffer."</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">interactive</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>navigate-nostar-buffer<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">navigate-previous-nostar-buffer</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-doc">"Navigate to previous \"no star\" buffer."</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">interactive</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>navigate-nostar-buffer t<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Puis on utilise <a href="https://www.gnu.org/software/emacs/manual/html_node/elisp/Remapping-Commands.html"><code>remap</code></a> pour réaffecter les raccourcis de <code>next-buffer</code> et <code>previous-buffer</code>, <kbd>C</kbd>-<kbd>x</kbd> <kbd>←</kbd> et <kbd>C</kbd>-<kbd>x</kbd> <kbd>→</kbd> respectivement.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">[</span>remap next-buffer<span class="org-rainbow-delimiters-depth-2">]</span> 'navigate-next-nostar-buffer<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">[</span>remap previous-buffer<span class="org-rainbow-delimiters-depth-2">]</span> 'navigate-previous-nostar-buffer<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org6b3b3e5" class="outline-2">
<h2 id="org6b3b3e5">Compilation</h2>
<div class="outline-text-2" id="text-org6b3b3e5">
<p>
Définit <code>run-compilation</code> et <code>end-compilation</code> qui sauvegardent et restaurent l'affichage des buffers lors d'une séance de compilation : Si l'on doit faire plusieurs allers / retours entre le buffer de compilation et les sources, pour comprendre et corriger les erreurs, on peut ensuite restaurer son environnement de travail.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">get-compilation-buffer</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-doc">"Get the compilation buffer, or nil if it does not exist."</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Voir aussi `</span><span class="org-comment"><span class="org-constant">compilation-buffer-name-function</span></span><span class="org-comment">'</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>car <span class="org-rainbow-delimiters-depth-3">(</span>cl-remove-if-not
        <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-keyword">lambda</span> <span class="org-rainbow-delimiters-depth-5">(</span>b<span class="org-rainbow-delimiters-depth-5">)</span>
          <span class="org-rainbow-delimiters-depth-5">(</span>equal <span class="org-string">"*compilation*"</span> <span class="org-rainbow-delimiters-depth-6">(</span>buffer-name b<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
        <span class="org-rainbow-delimiters-depth-4">(</span>buffer-list<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">get-compilation-layout-register</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-doc">"Returns the register used to save the layout before compilation,</span>
<span class="org-doc">and restore it later."</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>message <span class="org-string">"get-compilation-layout-register ()"</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">It seems we can use more than one letter register !</span>
  'comp-layout-reg<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">start-new-compilation</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-doc">"Prompt for command and run a new compilation"</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Passer en plein &#233;cran</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(let ((current-prefix-arg '(4)))   ; C-u</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">(call-interactively 'compile)))</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>call-interactively 'compile<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">return-to-compilation</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-doc">"Get compilation buffer back in full screen"</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Relancer la compil automatiquement ?</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>switch-to-buffer <span class="org-rainbow-delimiters-depth-3">(</span>get-compilation-buffer<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>delete-other-windows<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> ongoing-compilation-session nil<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">start-compilation-session</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-doc">"Save layout and start a new compilation session"</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>frame-configuration-to-register <span class="org-rainbow-delimiters-depth-3">(</span>get-compilation-layout-register<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>start-new-compilation<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">setq</span> ongoing-compilation-session t<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">end-compilation-session</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-doc">"Restore pre-compilation layout and terminate compilation session"</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Supprimer le buffer de compil ?</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">setq</span> ongoing-compilation-session nil<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>jump-to-register <span class="org-rainbow-delimiters-depth-3">(</span>get-compilation-layout-register<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">run-compilation</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-doc">"Start new compilation session or restore an old one"</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">interactive</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">and</span> ongoing-compilation-session <span class="org-rainbow-delimiters-depth-4">(</span>get-compilation-buffer<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
      <span class="org-rainbow-delimiters-depth-3">(</span>return-to-compilation<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>start-compilation-session<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">end-compilation</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-doc">"Terminate a compilation session"</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">interactive</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">if</span> ongoing-compilation-session
      <span class="org-rainbow-delimiters-depth-3">(</span>end-compilation-session<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Le buffer <code>*compilation*</code> défile jusqu'à la première erreur
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> compilation-scroll-output 'first-error<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Dans ce buffer, un clic sur une erreur emmène dans les sources, et <kbd>g</kbd> permet de relancer une nouvelle compilation.
</p>
</div>
</div>

<div id="outline-container-org6137d61" class="outline-2">
<h2 id="org6137d61">Copier/coller</h2>
<div class="outline-text-2" id="text-org6137d61">
<p>
Le bouton du milieu colle le texte au niveau du point, sans le déplacer
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> mouse-yank-at-point t<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Lorsqu'on copie depuis Emacs alors qu'une autre application avait placé du texte dans le presse-papier, ce texte est ajouté au kill ring avant d'être remplacé. Très pratique, car cela évite de perdre du texte copié, par exemple depuis internet, avant d'avoir eu le temps de l'utiliser.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> save-interprogram-paste-before-kill t<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Le texte surligné est automatiquement copié dans le kill ring
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> mouse-drag-copy-region t<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org59a62d7" class="outline-2">
<h2 id="org59a62d7">Parenthèses et Cie</h2>
<div class="outline-text-2" id="text-org59a62d7">
<p>
Lorsque le curseur est sur une parenthèse ouvrante, ou immédiatement derrière une parenthèse fermante, la paire de parenthèses est surlignée. De même avec les accolades et les crochets.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>show-paren-mode 1<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Éventuellement, si on veut surligner également l'expression entre parenthèses
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> show-paren-style 'expression<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Les parenthèses sont surlignées en bleu. Voir aussi <a href="#org7b72898">Rainbow delimiters</a>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>set-face-background 'show-paren-match <span class="org-string">"#b5d5ff"</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orge0baf3c" class="outline-2">
<h2 id="orge0baf3c">Suggestions</h2>
<div class="outline-text-2" id="text-orge0baf3c">
<p>
J'ai beaucoup utilisé (et apprécié) <code>iswitchb-mode</code>, et lorsqu'il est devenu obsolète, j'ai tenté de le remplacer par <code>icomplete-mode</code>, mais ce n'était convaincant, si bien que j'utilise maintenant <a href="#org11d3e0d">Helm</a>. Cette configuration (que je n'utilise plus) est ce que j'ai pu obtenir de mieux, avec un comportement ressemblant à <code>iswitchb-mode</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>icomplete-mode<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Suggère les buffers sur un <kbd>C</kbd>-<kbd>x</kbd> <kbd>b</kbd> avant qu'on commence à taper
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> icomplete-show-matches-on-no-input t<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Ignore la casse lorsqu'on demande à compléter avec <kbd>TAB</kbd>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> read-buffer-completion-ignore-case t<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Met en évidence dans le minibuffer le candidat qui pourrait être sélectionné
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>copy-face 'minibuffer-prompt 'icomplete-first-match<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Contourne les problèmes liés au buffer par défaut. En particulier, prend le premier élément de la liste, sélectionné avec <kbd>C</kbd>-<kbd>s</kbd> et <kbd>C</kbd>-<kbd>r</kbd>, sans qu'on ait commencé à saisir le nom d'un buffer. Voir réouverture du bug <a href="http://lists.gnu.org/archive/html/emacs-devel/2015-05/msg00473.html">#17545</a>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">my-icomplete-forward-completions</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-doc">"Step forward completions by one entry."</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">interactive</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">progn</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">setq</span> minibuffer-default nil<span class="org-rainbow-delimiters-depth-3">)</span>
         <span class="org-rainbow-delimiters-depth-3">(</span>icomplete-forward-completions<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">my-icomplete-backward-completions</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-doc">"Step backward completions by one entry."</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">interactive</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">progn</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">setq</span> minibuffer-default nil<span class="org-rainbow-delimiters-depth-3">)</span>
         <span class="org-rainbow-delimiters-depth-3">(</span>icomplete-backward-completions<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">my-minibuffer-force-complete-and-exit</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-doc">"Select the current completion."</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">interactive</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">progn</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">setq</span> minibuffer-default nil<span class="org-rainbow-delimiters-depth-3">)</span>
         <span class="org-rainbow-delimiters-depth-3">(</span>minibuffer-force-complete-and-exit<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">;;</span><span class="org-comment">Configure des raccourcis ressemblant &#224; ceux de iswitchb</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">when</span> <span class="org-rainbow-delimiters-depth-2">(</span>boundp 'icomplete-minibuffer-map<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">let</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>map icomplete-minibuffer-map<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>define-key map <span class="org-rainbow-delimiters-depth-4">(</span>kbd <span class="org-string">"C-s"</span><span class="org-rainbow-delimiters-depth-4">)</span> 'my-icomplete-forward-completions<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>define-key map <span class="org-rainbow-delimiters-depth-4">(</span>kbd <span class="org-string">"C-r"</span><span class="org-rainbow-delimiters-depth-4">)</span> 'my-icomplete-backward-completions<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>define-key map <span class="org-rainbow-delimiters-depth-4">(</span>kbd <span class="org-string">"C-j"</span><span class="org-rainbow-delimiters-depth-4">)</span> 'my-minibuffer-force-complete-and-exit<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>define-key map <span class="org-rainbow-delimiters-depth-4">(</span>kbd <span class="org-string">"C-&lt;return&gt;"</span><span class="org-rainbow-delimiters-depth-4">)</span> 'my-minibuffer-force-complete-and-exit<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orga6c5f60" class="outline-2">
<h2 id="orga6c5f60">Mise à jour du path</h2>
<div class="outline-text-2" id="text-orga6c5f60">
<p>
C'est parfois utile d'enrichir un peu le path utilisé par Emacs. Il y a en fait plusieurs chemins, dont ces deux variables :
</p>

<ul class="org-ul">
<li><code>exec-path</code>, qui est le path utilisé par Emacs pour chercher les binaires</li>
<li><code>PATH</code>, qui est le path transmis aux commandes lancées par Emacs</li>
</ul>

<p>
Pour ma part je les traite ensembles, avec la fonction <code>add-to-exec-paths</code>, qui
ajoute (s'il existe) à la fin des deux paths le répertoire passé en argument :
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">TODO - Filtrer les doublons</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">add-to-exec-paths</span><span class="org-rainbow-delimiters-depth-2">(</span>some-folder<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">interactive</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">cond</span>
   <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>file-exists-p some-folder<span class="org-rainbow-delimiters-depth-4">)</span>
    <span class="org-rainbow-delimiters-depth-4">(</span>add-to-list 'exec-path some-folder<span class="org-rainbow-delimiters-depth-4">)</span>
    <span class="org-comment-delimiter">;;</span><span class="org-comment">(message "exec-path=%s" exec-path)</span>
    <span class="org-rainbow-delimiters-depth-4">(</span>setenv <span class="org-string">"PATH"</span> <span class="org-rainbow-delimiters-depth-5">(</span>concat <span class="org-rainbow-delimiters-depth-6">(</span>getenv <span class="org-string">"PATH"</span><span class="org-rainbow-delimiters-depth-6">)</span> <span class="org-string">":"</span> some-folder<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
    <span class="org-comment-delimiter">;;</span><span class="org-comment">(message "PATH=%s" (getenv "PATH"))</span>
    <span class="org-rainbow-delimiters-depth-4">(</span>message <span class="org-string">"Added '%s' to PATH and exec-path"</span> some-folder<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Reste à ajouter quelques répertoires, selon ses habitudes&#x2026;
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>add-to-exec-paths <span class="org-string">"~/scripts"</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>add-to-exec-paths <span class="org-string">"~/local/bin"</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>add-to-exec-paths <span class="org-string">"/usr/bin"</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>add-to-exec-paths <span class="org-string">"/usr/local/bin"</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>add-to-exec-paths <span class="org-string">"/opt/local/bin"</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>add-to-exec-paths <span class="org-string">"c:/msys64/mingw64/bin"</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>add-to-exec-paths <span class="org-string">"c:/msys64/usr/bin/"</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgacc9b22" class="outline-2">
<h2 id="orgacc9b22">Valorisation du proxy</h2>
<div class="outline-text-2" id="text-orgacc9b22">
<p>
On cherche d'abord le proxy dans le fichier de configuration <code>~/.emacs.d/proxy.el</code> :
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> my-proxy <span class="org-rainbow-delimiters-depth-2">()</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-2">(</span>file-exists-p <span class="org-string">"~/.emacs.d/proxy.el"</span><span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">progn</span>
      <span class="org-rainbow-delimiters-depth-3">(</span>load-file <span class="org-string">"~/.emacs.d/proxy.el"</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Si ce fichier existe, il contient une simple ligne, telle que :
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> my-proxy 'proxy.mon.domaine.fr:80<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Si l'on ne l'a pas trouvé, on cherche dans l'environnement la variable <code>http_proxy</code>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">unless</span> my-proxy <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">setq</span> my-proxy <span class="org-rainbow-delimiters-depth-3">(</span>getenv <span class="org-string">"http_proxy"</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
On valorise correctement <code>url-proxy-services</code> et on affiche le proxy utilisé
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">if</span> my-proxy
    <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">progn</span>
      <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">setq</span> url-proxy-services <span class="org-rainbow-delimiters-depth-4">(</span>list <span class="org-rainbow-delimiters-depth-5">(</span>cons <span class="org-string">"http"</span> <span class="org-rainbow-delimiters-depth-6">(</span>symbol-name my-proxy<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
      <span class="org-rainbow-delimiters-depth-3">(</span>message <span class="org-string">"Set HTTP proxy to '%s'"</span> my-proxy<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Voir la doc d'<a href="http://www.emacswiki.org/emacs/UrlPackage#toc6">Url Package</a> sur EmacsWiki pour plus d'infos sur les proxys.
</p>
</div>
</div>

<div id="outline-container-orge8eeded" class="outline-2">
<h2 id="orge8eeded">Ajustements à l'OS</h2>
<div class="outline-text-2" id="text-orge8eeded">
<p>
Selon la plateforme, on effectue quelques ajustements, en particulier sur les polices de caractères.
</p>
</div>

<div id="outline-container-org3d167ea" class="outline-3">
<h3 id="org3d167ea">Sous Linux</h3>
<div class="outline-text-3" id="text-org3d167ea">
<p>
Fonte du terminal Xfce
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>set-default-font <span class="org-string">"Liberation Mono 10"</span> t t<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orge5b276f" class="outline-3">
<h3 id="orge5b276f">Sous Mac</h3>
<div class="outline-text-3" id="text-orge5b276f">
<p>
Réaffectation des touches à problèmes sur Mac :
</p>
<ul class="org-ul">
<li><kbd>cmd</kbd> devient <kbd>meta</kbd></li>
<li><kbd>alt</kbd> permet les raccourcis pour <kbd>|</kbd>, <kbd>~</kbd> et cie.</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> mac-option-key-is-meta nil<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> mac-command-key-is-meta t<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> mac-command-modifier 'meta<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> mac-option-modifier nil<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Fonte Xcode
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>set-face-font
 'menu <span class="org-string">"-apple-menlo-medium-r-normal--11-110-72-72-m-110-iso10646-1"</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>set-face-font
 'default <span class="org-string">"-apple-menlo-medium-r-normal--11-110-72-72-m-110-iso10646-1"</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org4f46ae5" class="outline-2">
<h2 id="org4f46ae5">Gestionnaire de paquets</h2>
<div class="outline-text-2" id="text-org4f46ae5">
<p>
Charge le gestionnaire de paquets
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>my-require 'package<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
On peut ensuite ajouter des sources de paquets, qui viendront alimenter la liste affichée par <code>package-list-packages</code>.
</p>

<p>
Milkypostman’s Emacs Lisp Package Archive (<a href="http://melpa.org">MELPA</a>), une source de paquets à avoir, la seule que j'ajoute systématiquement.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>add-to-list 'package-archives
             '<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"MELPA"</span> . <span class="org-string">"http://melpa.milkbox.net/packages/"</span><span class="org-rainbow-delimiters-depth-2">)</span> t<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Pour ceux qui veulent une version bien à jour de <a href="http://orgmode.org">Org</a>, la source dédiée est pratique également.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>add-to-list 'package-archives
             '<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"Org"</span> . <span class="org-string">"https://orgmode.org/elpa/"</span><span class="org-rainbow-delimiters-depth-2">)</span> t<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
En cas de problème avec les paquets, on peut supprimer le répertoire où tout est installé : <code>~/.emacs.d/elpa/archives/melpa/archive-contents</code>.
</p>

<p>
<a href="https://marmalade-repo.org">Marmelade</a> une autre source de paquets intéressante, moins dynamique que Melpa ces derniers temps, mais avec avec un système de validation différent.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>add-to-list 'package-archives
             '<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"Marmalade"</span> . <span class="org-string">"http://marmalade-repo.org/packages/"</span><span class="org-rainbow-delimiters-depth-2">)</span> t<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
GNU Emacs Lisp Package Archive (<a href="http://elpa.gnu.org">ELPA</a>) est la source de paquets officielle d'Emacs.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>add-to-list 'package-archives
             '<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"GNU"</span> . <span class="org-string">"http://elpa.gnu.org/packages/"</span><span class="org-rainbow-delimiters-depth-2">)</span> t<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
<a href="http://orgmode.org">Org</a> dispose également de sa propre source, pour ceux qui veulent garder très à jour ce paquet majeur.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>add-to-list 'package-archives
             '<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"Org"</span> . <span class="org-string">"http://orgmode.org/elpa/"</span><span class="org-rainbow-delimiters-depth-2">)</span> t<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Initialise le gestionnaire de paquet. Avec Helm, on peut utiliser <code>helm-list-elisp-packages</code> via <kbd>C</kbd>-<kbd>c</kbd> <kbd>h</kbd> <kbd>@</kbd>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>package-initialize<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf87292e" class="outline-2">
<h2 id="orgf87292e">Thème Leuven</h2>
<div class="outline-text-2" id="text-orgf87292e">
<p>
Les couleurs par défaut d'Emacs fonctionnent mal lorsqu'il est lancé en mode texte dans un terminal à fond noir, car les couleurs foncées de la mise en évidence de syntaxe ne ressortent pas. Le thème Leuven, sur fond blanc, est très bien intégré à Emacs (et particulièrement à <a href="#org717cad9">Org</a>), lisible et agréable en mode texte comme en mode graphique. Le gestionnaire de package initilisé, on regarde si Leuven est disponible, et si oui, on le charge.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-2">(</span>member 'leuven-theme <span class="org-rainbow-delimiters-depth-3">(</span>mapcar 'car package-alist<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">(</span>load-theme 'leuven t<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb55890c" class="outline-2">
<h2 id="orgb55890c">TabTab minor mode</h2>
<div class="outline-text-2" id="text-orgb55890c">
<p>
Une tentative pour changer le comportement de la touche <kbd>TAB</kbd> dans les fichiers CMake :
</p>
<ul class="org-ul">
<li><kbd>TAB</kbd> ne sert plus à indenter la ligne, mais aligne le texte sur le prochain arrêt de tabulation</li>
<li><kbd>S</kbd>-<kbd>TAB</kbd> remplit la fonction opposée, et aligne le texte sur l'arrêt de tabulation précédent</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">prev-tab-to-tab-stop</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-doc">"Remove spaces or tabs to next defined tab-stop column."</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">interactive</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">and</span> abbrev-mode <span class="org-rainbow-delimiters-depth-3">(</span>= <span class="org-rainbow-delimiters-depth-4">(</span>char-syntax <span class="org-rainbow-delimiters-depth-5">(</span>preceding-char<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span> ?w<span class="org-rainbow-delimiters-depth-3">)</span>
       <span class="org-rainbow-delimiters-depth-3">(</span>expand-abbrev<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">let</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>nexttab <span class="org-rainbow-delimiters-depth-5">(</span>indent-next-tab-stop <span class="org-rainbow-delimiters-depth-6">(</span>current-column<span class="org-rainbow-delimiters-depth-6">)</span> t<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>delete-horizontal-space t<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>indent-to nexttab<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">define-minor-mode</span> <span class="org-function-name">tab-tab-mode</span>
  <span class="org-doc">"Tab-to-tab in both directions"</span>
  <span class="org-builtin">:lighter</span> <span class="org-string">" TTm"</span>
  <span class="org-builtin">:keymap</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">let</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>map <span class="org-rainbow-delimiters-depth-5">(</span>make-sparse-keymap<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
            <span class="org-rainbow-delimiters-depth-3">(</span>define-key map <span class="org-rainbow-delimiters-depth-4">(</span>kbd <span class="org-string">"&lt;tab&gt;"</span><span class="org-rainbow-delimiters-depth-4">)</span> 'tab-to-tab-stop<span class="org-rainbow-delimiters-depth-3">)</span>
            <span class="org-rainbow-delimiters-depth-3">(</span>define-key map <span class="org-rainbow-delimiters-depth-4">(</span>kbd <span class="org-string">"S-&lt;tab&gt;"</span><span class="org-rainbow-delimiters-depth-4">)</span> 'prev-tab-to-tab-stop<span class="org-rainbow-delimiters-depth-3">)</span>
            map<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>add-hook 'cmake-mode-hook 'tab-tab-mode<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Cependant ça ne fonctionne pas très bien, car <code>cmake-mode</code> n'a pas l'air de prendre en compte la <i>key-map</i>. Et d'ailleurs si l'on tente d'installer les raccourcis avec un hook, ça ne fonctionne pas non plus&#x2026;
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>add-hook 'cmake-mode-hook <span class="org-rainbow-delimiters-depth-2">(</span>local-set-key <span class="org-rainbow-delimiters-depth-3">(</span>kbd <span class="org-string">"&lt;tab&gt;"</span><span class="org-rainbow-delimiters-depth-3">)</span> 'tab-to-tab-stop<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
À creuser donc. Voir <a href="http://nullprogram.com/blog/2013/02/06">How to Make an Emacs Minor Mode</a> pour un tutoriel clair et bien fait.
</p>
</div>
</div>

<div id="outline-container-org38d795a" class="outline-2">
<h2 id="org38d795a">Auto Complete</h2>
<div class="outline-text-2" id="text-org38d795a">
<p>
<a href="https://github.com/auto-complete/auto-complete/blob/master/doc/manual.md">Auto Complete</a> présente dans un menu en mode texte différents choix pour compléter le texte au point. Simple et efficace !
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>my-require 'auto-complete-config<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Les choix proposés proviennent d'un certain nombre de sources ; on utilise les sources par défaut, vérifiables avec <kbd>M</kbd>-<kbd>:</kbd> <code>ac-sources</code>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>ac-config-default<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Auto Complete ne s'active pas automatiquement dans tous les modes, mais seulement dans ceux listés dans <code>ac-modes</code>. Cette liste contient par défaut la majorité des modes où Auto Complete est intéressant, mais on peut quand même rajouter quelques uns :
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>add-to-list 'ac-modes 'cmake-mode<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>add-to-list 'ac-modes 'org-mode<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>add-to-list 'ac-modes 'text-mode<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Active Auto Complete dans tous les modes sélectionnés
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>global-auto-complete-mode t<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Le menu s'affiche sur demande, et non sur temporisation, avec le raccourci habituel <kbd>M</kbd>-<kbd>/</kbd>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> ac-auto-start nil<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"M-/"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'auto-complete<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
<kbd>C</kbd>-<kbd>s</kbd> permet de filtrer une sous-chaine dans le menu
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> ac-use-menu-map t<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>

<div id="outline-container-orgae9c15d" class="outline-3">
<h3 id="orgae9c15d">Recherche approximative</h3>
<div class="outline-text-3" id="text-orgae9c15d">
<p>
On souhaite profiter de la recherche approximative, dans le cas d'un préfix mal orthographié ou écrit en abrégé.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> ac-use-fuzzy t<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Cela fonctionne au minimum avec le contenu du buffer courant, mais manifestement pas avec les autres sources. Et même avec le buffer courant, il semblerait que Fuzzy ait ses raisons, que la raison ignore : soit le fichier texte contenant cette seule ligne
</p>

<pre class="example">
aaaaaaaabbbbccd
</pre>

<p>
Diverses tentatives pour compléter ce mot donnent les résultats suivants
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">préfix erroné</th>
<th scope="col" class="org-left">résultat</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">aaaab</td>
<td class="org-left">échoue</td>
</tr>

<tr>
<td class="org-left">aaaaab</td>
<td class="org-left">ok</td>
</tr>

<tr>
<td class="org-left">aaaabb</td>
<td class="org-left">échoue</td>
</tr>

<tr>
<td class="org-left">aaaaabc</td>
<td class="org-left">échoue</td>
</tr>

<tr>
<td class="org-left">aaaaabbc</td>
<td class="org-left">ok</td>
</tr>
</tbody>
</table>

<p>
Nécessite le paquet <code>fuzzy</code> pour fonctionner une fois de temps en temps.
</p>
</div>
</div>

<div id="outline-container-orgfdbb98a" class="outline-3">
<h3 id="orgfdbb98a">Intégration à Helm</h3>
<div class="outline-text-3" id="text-orgfdbb98a">
<p>
Intègre Auto Complete à Helm, et permet d'avoir avec <kbd>C</kbd>-<kbd>:</kbd> dans un buffer helm, le contenu du menu qu'on aurait eu avec <kbd>M</kbd>-<kbd>/</kbd>. Nécessite le paquet <code>ac-helm</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"C-:"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'ac-complete-with-helm<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgfcca676" class="outline-3">
<h3 id="orgfcca676">Source pour completion-at-point</h3>
<div class="outline-text-3" id="text-orgfcca676">
<p>
Une source pour <code>completion-at-point</code>, très utile par exemple pour <code>rust-mode</code> avec Racer. Nécessite le paquet <a href="https://github.com/syohex/emacs-ac-capf"><code>ac-capf</code></a>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>add-hook 'prog-mode-hook 'ac-capf-setup<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>
</div>


<div id="outline-container-orgd9b435d" class="outline-2">
<h2 id="orgd9b435d">Bookmarks</h2>
<div class="outline-text-2" id="text-orgd9b435d">
<p>
Marque-pages à la Visual Studio : la ligne marquée est surlignée, et l'on peut ensuite naviguer d'un marque-page à l'autre. Beaucoup d'autres fonctionnalités très pratiques comme mettre les marque-pages automatiquement avec une expression régulière, par exemple pour explorer des logs.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>my-require 'bm<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
On parcourt avec <code>bm-next</code> et <code>bm-previous</code> l'ensemble des marque-pages de tous les buffers, et pas juste ceux du buffer courant.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> bm-cycle-all-buffers t<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
On surligne les lignes marquées en fuchsia, comme avec un coup de Stabilo !
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>custom-set-faces
 '<span class="org-rainbow-delimiters-depth-2">(</span>bm-face <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>t <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-builtin">:background</span> <span class="org-string">"#ffafff"</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org61cbd29" class="outline-2">
<h2 id="org61cbd29">C &amp; C++</h2>
<div class="outline-text-2" id="text-org61cbd29">
<p>
Accolades ouvrantes alignées sous le mot clé
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>c-set-offset <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">quote</span> substatement-open<span class="org-rainbow-delimiters-depth-2">)</span> 0<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Ouvre les <code>.h</code> comme du C++, et non comme du C
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> auto-mode-alist <span class="org-rainbow-delimiters-depth-2">(</span>append '<span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"</span><span class="org-string"><span class="org-warning">\</span></span><span class="org-string">.h$"</span> . c++-mode<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span> auto-mode-alist<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>

<div id="outline-container-org6795a6a" class="outline-3">
<h3 id="org6795a6a">Global</h3>
<div class="outline-text-3" id="text-org6795a6a">
<p>
Une configuration simple pour GNU Global, en remplacement du vénérable Etags, et qui fonctionne un peu moins mal que ce dernier avec C++.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>my-require 'ggtags<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>add-hook 'c-mode-common-hook 'ggtags-mode<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Reprend les raccourcis usuels d'Etags:
</p>

<ul class="org-ul">
<li><kbd>M</kbd>-<kbd>.</kbd> pour aller à la définition d'un symbole</li>
<li><kbd>M</kbd>-<kbd>*</kbd> pour revenir d'où on vient</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>add-hook 'c-mode-common-hook <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">lambda</span> <span class="org-rainbow-delimiters-depth-3">()</span> <span class="org-rainbow-delimiters-depth-3">(</span>local-set-key <span class="org-rainbow-delimiters-depth-4">(</span>kbd <span class="org-string">"M-."</span><span class="org-rainbow-delimiters-depth-4">)</span> 'gtags-find-tag<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>add-hook 'c-mode-common-hook <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">lambda</span> <span class="org-rainbow-delimiters-depth-3">()</span> <span class="org-rainbow-delimiters-depth-3">(</span>local-set-key <span class="org-rainbow-delimiters-depth-4">(</span>kbd <span class="org-string">"M-*"</span><span class="org-rainbow-delimiters-depth-4">)</span> 'pop-tag-mark<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Global, comme la plupart des autres outils d'indexation, ne fonctionne pas très bien avec C++, et nécessite en plus d'être configuré et périodiquement relancé&#x2026; Il se trouve que <code>helm-projectile-grep</code> fonctionne tellement bien, que je n'utilise presque plus que ça pour naviguer dans les projets.
</p>
</div>
</div>
</div>

<div id="outline-container-orgca687e0" class="outline-2">
<h2 id="orgca687e0">Column Marker</h2>
<div class="outline-text-2" id="text-orgca687e0">
<p>
Surligne les caractères qui tombent sur certaines colonnes. On peut configurer plusieurs colonnes, par exemple à 70 et 80 caractères. Visuellement moins réussi que <a href="#org8b89af6">Fill column indicator</a>, mais cause moins de problèmes de compatibilité que ce dernier. Je le garde dans ma configuration, mais je ne l'utilise plus.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>my-require 'column-marker<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Si l'on est dans un mode de programmation, surligne le caractère tombant après la 80<sup>e</sup> colonne.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>add-hook 'prog-mode-hook
          <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">lambda</span> <span class="org-rainbow-delimiters-depth-3">()</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">interactive</span><span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-3">(</span>column-marker-1 80<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org6abb81e" class="outline-2">
<h2 id="org6abb81e">CMake</h2>
<div class="outline-text-2" id="text-org6abb81e">
<p>
Le mode majeur pour éditer les fichiers CMake. Perfectible à mon avis, mais utile quand même. Plus d'informations sur le <a href="http://www.cmake.org/Wiki/CMake/Editors/Emacs">wiki</a> de Kitware dédié à CMake.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>my-require 'cmake-mode<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Les fichiers CMake habituels s'ouvrent avec <code>cmake-mode</code>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> auto-mode-alist
      <span class="org-rainbow-delimiters-depth-2">(</span>append '<span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"CMakeLists\\.txt\\'"</span> . cmake-mode<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
              '<span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"\\.cmake\\'"</span> . cmake-mode<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
              auto-mode-alist<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Pas d'indentation automatique, en particulier après <kbd>Enter</kbd>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>add-hook 'cmake-mode-hook <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">lambda</span> <span class="org-rainbow-delimiters-depth-3">()</span> <span class="org-rainbow-delimiters-depth-3">(</span>electric-indent-mode -1<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org25c614d" class="outline-2">
<h2 id="org25c614d">DTrace</h2>
<div class="outline-text-2" id="text-org25c614d">
<p>
Un mode majeur pour DTrace, très bel outil d'instrumentation et d'analyse issu de Sun, à l'avenir bien incertain. Il reste utile sur macOS puisqu'il est derrière <a href="https://developer.apple.com/library/content/documentation/DeveloperTools/Conceptual/InstrumentsUserGuide">Instruments</a>. Plus d'infos sur le <a href="http://dtrace.org/blogs/ahl/tag/dtrace">blog</a> de l'un de ses auteurs.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>my-require 'dtrace-script-mode<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Les fichiers <code>.d</code> sont des scripts DTrace et s'ouvrent avec <code>dtrace-script-mode</code>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> auto-mode-alist
      <span class="org-rainbow-delimiters-depth-2">(</span>append '<span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"\\.d\\'"</span> . dtrace-script-mode<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
              auto-mode-alist<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org304f9ab" class="outline-2">
<h2 id="org304f9ab">EasyPG Assistant</h2>
<div class="outline-text-2" id="text-org304f9ab">
<p>
Une interface à GnuPG pour Emacs, qui permet entre autres de manipuler des fichiers cryptés. GnuPG doit être installé et configuré sur la machine.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>my-require 'epa-file<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Rend transparent la lecture et l'écriture des fichiers <code>.gpg</code>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>epa-file-enable<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Indique à EasyPG une clé par défaut, afin qu'il ne pose pas la question à chaque sauvegarde d'un fichier. Je vous laisse mettre la vôtre !
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> epa-file-encrypt-to <span class="org-string">"julien.montmartin@fastmail.fm"</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Fonctionne bien aussi dans une variable en début de fichier :
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">-*- epa-file-encrypt-to: <span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"julien.montmartin@fastmail.fm"</span><span class="org-rainbow-delimiters-depth-1">)</span> -*-
</pre>
</div>
</div>
</div>

<div id="outline-container-org2b200fe" class="outline-2">
<h2 id="org2b200fe">Ediff</h2>
<div class="outline-text-2" id="text-org2b200fe">
<p>
Un mode très pratique pour gérer les diffs.
</p>

<p>
Les fichiers à comparer sont ouverts cote à cote, et non pas l'un en dessous de l'autre. On aurait presque envie de dire que la fenêtre est partagée verticalement, mais pour une obscure raison, la fonction concernée s'appelle au contraire <code>split-window-horizontally</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> ediff-split-window-function 'split-window-horizontally<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Ediff n'ouvre pas de nouvelle fenêtre, tout se passe dans la fenêtre courante, en mode graphique comme en mode texte.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> ediff-window-setup-function 'ediff-setup-windows-plain<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgbd3b6fa" class="outline-2">
<h2 id="orgbd3b6fa">Find File At Point</h2>
<div class="outline-text-2" id="text-orgbd3b6fa">
<p>
Sur un <kbd>C</kbd>-<kbd>x</kbd> <kbd>C</kbd>-<kbd>f</kbd> FFAP essaie de deviner le fichier à ouvrir en fonction du texte sous le curseur, ce qui fonctionne avec les includes par exemple.
</p>

<p>
Active FFAP et remplace quelques raccourcis comme <kbd>C</kbd>-<kbd>x</kbd> <kbd>C</kbd>-<kbd>f</kbd>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>ffap-bindings<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Avant <a href="#org7e7c72d">Projectile</a>, FFAP était très pratique pour passer d'un <code>.h</code> à un <code>.cpp</code>. Mais comme la recherche s'effectue sur la base de chemins prédéfinis, ça ne fonctionne pas bien avec les hiérarchies un peu compliquées.
</p>

<p>
J'utilisais <kbd>C</kbd>-<kbd>t</kbd> (avec un 't' comme <i>toggle</i>) pour basculer entre source et entête, mais je réserve maintenant ce raccourci pour <code>'projectile-find-other-file</code>, plus efficace dès lors qu'on a un dépôt qui puisse faire office de projet.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"C-t"</span><span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">quote</span> ff-find-other-file<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Ajoute quelques chemins usuels pour trouver les sources et les entêtes
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> ff-search-directories
      '<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"."</span> <span class="org-string">".."</span>
        <span class="org-string">"./src"</span> <span class="org-string">"./include"</span>
        <span class="org-string">"../src"</span> <span class="org-string">"../include"</span>
        <span class="org-string">"../src/*"</span>  <span class="org-string">"../include/*"</span>
        <span class="org-string">"../../src"</span> <span class="org-string">"../../include"</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org8b89af6" class="outline-2">
<h2 id="org8b89af6">Fill column indicator</h2>
<div class="outline-text-2" id="text-org8b89af6">
<p>
Mode qui permet de visualiser la 80<sup>e</sup> colonne (ou n'importe quelle autre). Pratique, mais pas sans inconvénients. Mes préférés : <a id="org1f829c6"></a>
</p>

<ul class="org-ul">
<li>casse les menus d'<code>auto-complete</code></li>
<li>casse l'export HTML des fichiers <a href="#org717cad9">Org</a></li>
<li>copie-colle des pipes depuis le terminal</li>
</ul>

<p>
Avoir besoin de <code>fci-mode</code>, c'est devoir choisir entre la peste et le choléra (n'ayons pas peur des mots !).
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">ignore-errors</span> <span class="org-rainbow-delimiters-depth-2">(</span>my-require 'fill-column-indicator<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Matérialise la colonne 80
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq-default</span> fci-rule-column 80<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Active FCI dans tous les modes de développement
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>add-hook 'prog-mode-hook 'fci-mode<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgfa09730" class="outline-2">
<h2 id="orgfa09730">Graphviz</h2>
<div class="outline-text-2" id="text-orgfa09730">
<p>
Mode majeur pour éditer les fichiers Graphviz, outil très pratique pour dessiner des graphes ou des diagrammes de classe. S'intègre très bien à <a href="#org717cad9">Org</a>, ce qui ne gâche rien !
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>my-require 'graphviz-dot-mode<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Pour effectuer un rendu depuis Emacs avec <kbd>C</kbd>-<kbd>c</kbd> <kbd>v</kbd>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>define-key graphviz-dot-mode-map <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"C-c v"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'graphviz-dot-preview<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org11d3e0d" class="outline-2">
<h2 id="org11d3e0d">Helm</h2>
<div class="outline-text-2" id="text-org11d3e0d">
<p>
<a href="https://github.com/emacs-helm/helm/wiki">Helm</a> - Un framework plus qu'un simple module, de suggestion et d'aide à la sélection. S'appliquera bientôt à tous les aspects d'Emacs. Beaucoup plus intrusif que son principal concurrent, <a href="https://www.emacswiki.org/emacs/InteractivelyDoThings">Ido</a>, il change radicalement l'expérience utilisateur, et j'ai mis du temps à sauter le pas. Si ce n'est pas déjà fait, je vous encourage à faire de même ! En plus du nombre incroyable de fonctionnalités simplifiées et enrichies, Helm favorise la découverte et l'exploration d'Emacs. Que du bon en fin de compte !
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>my-require 'helm<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Pas nécessaire d'après la doc, mais certaines versions fonctionnent mieux avec !
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">require</span> '<span class="org-constant">helm-config</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Préfixe pour les commandes Helm, remplace <kbd>C</kbd>-<kbd>x</kbd> <kbd>c</kbd> (à faire avant que Helm ne soit chargé)
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"C-c h"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'helm-command-prefix<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-unset-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"C-x c"</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Le traditionnel <kbd>M</kbd>-<kbd>x</kbd> appelle la version Helm de <code>execute-extended-command</code>. Beaucoup de raccourcis appellent des commandes ainsi redéfinies. En particulier :
</p>

<ul class="org-ul">
<li><kbd>C</kbd>-<kbd>x</kbd> <kbd>C</kbd>-<kbd>f</kbd> permet parcourir et sélectionner les fichiers avec <code>helm-find-files</code></li>
<li><kbd>C</kbd>-<kbd>x</kbd> <kbd>r</kbd> <kbd>b</kbd> permet de parcourir et sélectionner ses marque-pages avec <code>helm-filtered-bookmarks</code></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"M-x"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'helm-M-x<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"C-x C-f"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'helm-find-files<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"C-x r b"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'helm-filtered-bookmarks<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Dans un buffer Helm, <kbd>TAB</kbd> essaye de compléter ce qui peut l'être
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>define-key helm-map <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"&lt;tab&gt;"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'helm-execute-persistent-action<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Pour lister les actions, à la place de <kbd>TAB</kbd>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>define-key helm-map <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"C-z"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'helm-select-action<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Dans un chemin, sélectionne immédiatement un répertoire dès lors qu'il est le seul à correspondre à la saisie
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> helm-ff-auto-update-initial-value t<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
S'il est disponible, on utilise cURL pour télécharger des données
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">when</span> <span class="org-rainbow-delimiters-depth-2">(</span>executable-find <span class="org-string">"curl"</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">setq</span> helm-net-prefer-curl t<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Ouvre le buffer Helm en partageant le buffer courant (partage horizontal)
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> helm-split-window-in-side-p t<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Quand on arrive à la fin des candidats, on boucle et on retourne au début
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> helm-move-to-line-cycle-in-source t<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Une couleur plus discrète pour les répertoires <code>.</code> et <code>..</code>. La couleur par défaut est trop foncée : Elle donne l'impression qu'ils sont toujours sélectionnés quand on préfèrerait au contraire moins les voir.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>custom-set-faces
 '<span class="org-rainbow-delimiters-depth-2">(</span>helm-ff-dotted-directory <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>t <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-builtin">:foreground</span> <span class="org-string">"DimGrey"</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Finalement, on active Helm
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>helm-mode t<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Pour plus de lecture, voir cette introduction à Helm : <a href="http://tuhdo.github.io/helm-intro.html">A Package in a league of its own</a>.
</p>
</div>
</div>

<div id="outline-container-org95f6cbb" class="outline-2">
<h2 id="org95f6cbb">Htmlize</h2>
<div class="outline-text-2" id="text-org95f6cbb">
<p>
Ce paquet définit <code>htmlize-buffer</code>, qui permet d'exporter un buffer en HTML, tout en respectant la mise en évidence de syntaxe réalisée par Emacs. Simple et efficace, même si <a href="#org717cad9">Org</a>, avec ses blocs <code>#+BEGIN_SRC</code> et <code>#+END_SRC</code>, offre souvent une bonne alternative.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>my-require 'htmlize<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org96d8395" class="outline-2">
<h2 id="org96d8395">Idle HighLight Mode</h2>
<div class="outline-text-2" id="text-org96d8395">
<p>
Après un petit temps d'inactivité, surligne toutes les occurrences du mot se trouvant sous le curseur. Notepad++ fait cela par défaut. Très pratique pour voir où un symbole est utilisé, et repérer les fautes de frappe.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>my-require 'idle-highlight-mode<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Ce mode mineur est activé dans tous les modes de développement.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>add-hook 'prog-mode-hook <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">lambda</span> <span class="org-rainbow-delimiters-depth-3">()</span> <span class="org-rainbow-delimiters-depth-3">(</span>idle-highlight-mode t<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orga88ed85" class="outline-2">
<h2 id="orga88ed85">Emacs Lisp</h2>
<div class="outline-text-2" id="text-orga88ed85">
<p>
Dans les contextes où il y a du Lisp, on affiche les éventuelles informations disponibles sur une fonction ou une variable dans la zone d'écho, c.à.d à l'emplacement du minibuffer.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>add-hook 'emacs-lisp-mode-hook 'eldoc-mode<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>add-hook 'lisp-interaction-mode-hook 'eldoc-mode<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>add-hook 'ielm-mode-hook 'eldoc-mode<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
IELM est un mode assez utile pour tester des petits bouts de Lisp. Il s'agit d'un Read-Eval-Print-Loop comme en ont la plupart des langages interprétés. Une très courte introduction dans ce billet <a href="http://emacs-fu.blogspot.fr/2011/03/ielm-repl-for-emacs.html">IELM: a REPL for emacs</a>.
</p>
</div>
</div>

<div id="outline-container-org7032d0b" class="outline-2">
<h2 id="org7032d0b">Magit</h2>
<div class="outline-text-2" id="text-org7032d0b">
<p>
Un module à essayer si vous êtes utilisateur de Git et d'Emacs. On ne charge ce module que si la commande <code>git</code> est présente, pour éviter une bête erreur qui paralyse Emacs au démarrage.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>my-require 'magit<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
La plupart des opérations dans Magit commencent par le buffer <code>status</code> accessible par le raccourci <kbd>C</kbd>-<kbd>x</kbd> <kbd>g</kbd>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"C-x g"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'magit-status<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org60e5373" class="outline-2">
<h2 id="org60e5373">MMM Mode</h2>
<div class="outline-text-2" id="text-org60e5373">
<p>
Permet de faire cohabiter plusieurs modes majeurs dans un même buffer.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>my-require 'mmm-auto<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Reparse un buffer qui a été modifié dès qu'Emacs a un peu de temps
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> mmm-parse-when-idle t<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Ce mode n'est pas activé automatiquement, mais uniquement dans les buffer pour lesquels on va définir une règle de sous mode
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> mmm-global-mode 'sometimes<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Définit la règle here-doc qui active le mode <code>shell-script-mode</code> entre les motifs <code>&lt;&lt;EOF</code> et <code>^EOF</code>, qui délimitent habituellement un <i>here document</i>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>mmm-add-classes
 '<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-rainbow-delimiters-depth-3">(</span>here-doc
    <span class="org-builtin">:submode</span> shell-script-mode
    <span class="org-builtin">:front</span> <span class="org-string">"&lt;&lt;EOF"</span>
    <span class="org-builtin">:back</span> <span class="org-string">"^EOF"</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
La règle here-doc est activée dans les buffers qui sont dans le très élémentaire mode <code>text-mode</code> (sans critère d'extension)
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>mmm-add-mode-ext-class 'text-mode nil 'here-doc<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org717cad9" class="outline-2">
<h2 id="org717cad9">Org</h2>
<div class="outline-text-2" id="text-org717cad9">
<p>
Un autre mode exceptionnel. Au départ un <i>outliner</i>, puis un outil de publication avec environnement de <i>literate programming</i>, mais aussi de GTD, de suivi de temps, un agenda, etc.
</p>

<p>
Les lignes ne sont pas tronquées. Plus pratique comme ça, tant pis pour les tableaux !
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> org-startup-truncated nil<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Les lignes sont indentées selon leur profondeur dans l'arborescence
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> org-startup-indented t<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Dans les blocs de code, on veut la mise en évidence de syntaxe, et l'on utilise la touche <kbd>TAB</kbd> pour indenter (et non pour insérer une tabulation)
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> org-src-fontify-natively t<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> org-src-tab-acts-natively t<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Les blocs de code sont évalués sans demande de confirmation, ainsi que les liens spéciaux qui exécutent du shell ou du Lisp
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> org-confirm-babel-evaluate nil<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> org-confirm-shell-link-function nil<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> org-confirm-elisp-link-function nil<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Sauf indication contraire, les éléments de texte générés par Org sont en français
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> org-export-default-language <span class="org-string">"fr"</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Concernant l'export (en HTML par exemple) :
</p>
<ul class="org-ul">
<li>On ne veut pas que les titres des sections soient numérotés</li>
<li>Au-delà de trois niveaux de titres, on préfère des listes</li>
<li>On ne veut pas d'auteur (valorisé par Org avec le nom de l'utilisateur)</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> org-export-with-section-numbers nil<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> org-export-headline-levels 3<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> org-export-with-author nil<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Dans le cas particulier de l'export HTML, on veut également que la mise en évidence de syntaxe soit faite à l'aide d'un fichier CSS à part. C'est particulièrement utile avec le mode batch dans lequel les attributs des polices ne sont pas chargés. On peut produire un fichier CSS de référence avec la commande `org-html-htmlize-generate-css`.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> org-html-htmlize-output-type 'css<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>

<div id="outline-container-org3e11a11" class="outline-3">
<h3 id="org3e11a11">Mise à jour</h3>
<div class="outline-text-3" id="text-org3e11a11">
<p>
La dernière version d'Org n'est en général pas celle qui est livrée avec Emacs. Il faut la mettre à jour avec le gestionnaire de paquets. Pour une raison que j'ignore, Org n'est pas listé comme <i>built-in</i>, mais quand on l'installe manuellement, le gestionnaire de paquet indique bien "shadowing a built-in package".
</p>

<p>
Ensuite, en cas de bug suspect, il se peut qu'il faille supprimer les fichiers lisp précompilés se trouvant dans <code>~/.emacs.d/elpa/org-x.y.z</code>, relancer Emacs, puis les générer à nouveau avec <code>byte-recompile-directory</code>.
</p>
</div>
</div>
</div>

<div id="outline-container-org8e0bfae" class="outline-2">
<h2 id="org8e0bfae">Perforce</h2>
<div class="outline-text-2" id="text-org8e0bfae">
<p>
Permet d'utiliser Perforce depuis Emacs, principalement pour sortir des fichiers. Conventionnellement, les fichiers sont en lecture seule. Lorsqu'il les sort, Perforce les passe en lecture / écriture.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>my-require 'p4<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Le client Perforce en ligne de commande doit être correctement configuré. Le fichier caché <code>.P4CONFIG</code> contient les informations de connexion.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>setenv <span class="org-string">"P4CONFIG"</span> <span class="org-string">".P4CONFIG"</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Lorsqu'elle doit sortir un fichier, la commande Perforce cherche les informations de connexion dans le répertoire du fichier, puis dans son répertoire parent, etc. Jusqu'à la racine. Un bon endroit pour placer le fichier <code>.P4CONFIG</code> est donc la racine du dépôt Perforce.
</p>

<p>
Ce fichier contient par exemple les informations de connexion suivantes :
</p>

<pre class="example">
P4PASSWD=xxxxxxxx
P4CLIENT=precise-dell-jmo
P4USER=julien.montmartin
P4PORT=srv-sources:1666
</pre>
</div>
</div>

<div id="outline-container-orgd9dfcbf" class="outline-2">
<h2 id="orgd9dfcbf">Prettify Symbols</h2>
<div class="outline-text-2" id="text-orgd9dfcbf">
<p>
<code>prettify-symbols-mode</code> permet de remplacer certaines séquences par un caractère composé (ou de faire des ligatures, pour reprendre la terminologie d'autres éditeurs). Par exemple, lorsqu'on écrit <code>a&lt;=b</code>, Emacs affiche <code>a≤b</code>. Les séquences à <i>enjoliver</i> sont définies par la liste <code>prettify-symbols-alist</code>, que chaque mode majeur est susceptible d'enrichir. Dans la pratique toutefois, elle semble vide la plupart du temps. Voici donc quelques ajouts  faits au niveau de <code>prog-mode</code>, dont tous les modes de développement dérivés profiteront.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>add-hook 'prog-mode-hook
          <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">lambda</span> <span class="org-rainbow-delimiters-depth-3">()</span>
            <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">push</span> '<span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"/="</span> . ?&#8800;<span class="org-rainbow-delimiters-depth-4">)</span> prettify-symbols-alist<span class="org-rainbow-delimiters-depth-3">)</span>
            <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">push</span> '<span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"!="</span> . ?&#8800;<span class="org-rainbow-delimiters-depth-4">)</span> prettify-symbols-alist<span class="org-rainbow-delimiters-depth-3">)</span>
            <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">push</span> '<span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"=="</span> . ?&#10869;<span class="org-rainbow-delimiters-depth-4">)</span> prettify-symbols-alist<span class="org-rainbow-delimiters-depth-3">)</span>
            <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">push</span> '<span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"&amp;&amp;"</span> . ?&#8743;<span class="org-rainbow-delimiters-depth-4">)</span> prettify-symbols-alist<span class="org-rainbow-delimiters-depth-3">)</span>
            <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">push</span> '<span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"||"</span> . ?&#8744;<span class="org-rainbow-delimiters-depth-4">)</span> prettify-symbols-alist<span class="org-rainbow-delimiters-depth-3">)</span>
            <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">push</span> '<span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"&lt;="</span> . ?&#8804;<span class="org-rainbow-delimiters-depth-4">)</span> prettify-symbols-alist<span class="org-rainbow-delimiters-depth-3">)</span>
            <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">push</span> '<span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"&gt;="</span> . ?&#8805;<span class="org-rainbow-delimiters-depth-4">)</span> prettify-symbols-alist<span class="org-rainbow-delimiters-depth-3">)</span>
            <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">push</span> '<span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"&lt;&lt;"</span> . ?&#8810;<span class="org-rainbow-delimiters-depth-4">)</span> prettify-symbols-alist<span class="org-rainbow-delimiters-depth-3">)</span>
            <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">push</span> '<span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"&gt;&gt;"</span> . ?&#8811;<span class="org-rainbow-delimiters-depth-4">)</span> prettify-symbols-alist<span class="org-rainbow-delimiters-depth-3">)</span>
            <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">push</span> '<span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"::"</span> . ?&#8759;<span class="org-rainbow-delimiters-depth-4">)</span> prettify-symbols-alist<span class="org-rainbow-delimiters-depth-3">)</span>
            <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">push</span> '<span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"-&gt;"</span> . ?&#8594;<span class="org-rainbow-delimiters-depth-4">)</span> prettify-symbols-alist<span class="org-rainbow-delimiters-depth-3">)</span>
            <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">push</span> '<span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"=&gt;"</span> . ?&#8658;<span class="org-rainbow-delimiters-depth-4">)</span> prettify-symbols-alist<span class="org-rainbow-delimiters-depth-3">)</span>
            <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">push</span> '<span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"and"</span> . ?&#8743;<span class="org-rainbow-delimiters-depth-4">)</span> prettify-symbols-alist<span class="org-rainbow-delimiters-depth-3">)</span>
            <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">push</span> '<span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"not"</span> . ?&#172;<span class="org-rainbow-delimiters-depth-4">)</span> prettify-symbols-alist<span class="org-rainbow-delimiters-depth-3">)</span>
            <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">push</span> '<span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"or"</span> . ?&#8744;<span class="org-rainbow-delimiters-depth-4">)</span> prettify-symbols-alist<span class="org-rainbow-delimiters-depth-3">)</span>
            <span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Pour fixer les idées, voici ce à quoi ça ressemble sur quelques lignes de C++
</p>

<div class="org-src-container">
<pre class="src src-C++"><span class="org-type">void</span> <span class="org-function-name">foo</span><span class="org-rainbow-delimiters-depth-1">(</span>std&#8759;<span class="org-type">pair</span><span class="org-rainbow-delimiters-depth-2">&lt;</span><span class="org-type">int</span>, <span class="org-type">int</span><span class="org-rainbow-delimiters-depth-2">&gt;</span>* p<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">{</span>
    <span class="org-comment-delimiter">//</span><span class="org-comment">Print something if first != second</span>
    <span class="org-keyword">if</span><span class="org-rainbow-delimiters-depth-2">(</span>p &#8800; <span class="org-constant">nullptr</span> &#8743; <span class="org-rainbow-delimiters-depth-3">(</span>p&#8594;first &#8800; p&#8594;second<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
        std&#8759;cout &#8810; p&#8594;first &#171; <span class="org-string">"!="</span> &#8810; p&#8594;second &#171; std&#8759;endl;
<span class="org-rainbow-delimiters-depth-1">}</span>
</pre>
</div>

<p>
On note que les séquences ne sont pas remplacées dans les chaines de caractères ni dans les commentaires. Elles ne sont pas non plus exportées par <a href="#org717cad9">Org</a> (j'ai modifié cet exemple à la main). Par ailleurs, la longueur des lignes reste correctement calculée, ce qui <i>facilite</i> la cohabitation avec les paquets comme <code>fci-mode</code>. Il reste quelques petits problèmes, comme une petite <i>marche</i> sur la limite pour les lignes trop longues, mais avec <code>fci-mode</code>, il faut savoir faire des <a href="#org1f829c6">compromis</a>&#x2026;
</p>

<p>
J'utilise Prettify Symbols depuis peu de temps, il est donc encore en phase de test. Pour l'instant, on l'active dans tous les modes qui le supportent.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>global-prettify-symbols-mode t<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>


<div id="outline-container-org7e7c72d" class="outline-2">
<h2 id="org7e7c72d">Projectile</h2>
<div class="outline-text-2" id="text-org7e7c72d">
<p>
Un module qui fournit une fonctionnalité bien pratique : regrouper les fichiers d'un même projet. Lorsqu'on ouvre un fichier, Projectile cherche un dépôt (via la présence d'un <code>.git</code> ou autre) dans le répertoire du fichier ouvert, puis dans ses répertoires parents.
</p>

<p>
S'il identifie un dépôt, Projectile considère que tous les fichiers du dépôt font partie d'un même projet, et fournit des fonctions pour les traiter ensemble.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>my-require 'projectile<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Active Projectile dans tous les modes le supportant
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>projectile-global-mode<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Raccourci <kbd>C</kbd>-<kbd>t</kbd> pour <code>projectile-find-other-file</code> qui ouvre un fichier associé : Si, par exemple, on est dans un buffer visitant <code>foo.h</code>, Projectile cherche dans le projet <code>foo.c</code>, et l'ouvre s'il le trouve. J'utilisais avant <a href="#orgbd3b6fa">Find File At Point</a> pour cette fonctionnalité, mais je trouve maintenant Projectile plus efficace.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"C-t"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'projectile-find-other-file<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Projectile utilise Helm pour l'aide à la sélection
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> projectile-completion-system 'helm<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Active les raccourcis Helm pour les fonctions Projectile. Il semblerait qu'il faille installer le paquet <code>helm-projectile</code>, mais qu'il ne soit pas nécessaire ensuite de faire un require dessus&#x2026;
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>helm-projectile-on<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orge0b9512" class="outline-2">
<h2 id="orge0b9512">Qt</h2>
<div class="outline-text-2" id="text-orge0b9512">
<p>
Pour ceux qui développent avec Qt, la fonction <code>generate-qt-includes</code> appelle un petit morceau de shell qui essaie de générer la liste des entêtes nécessaires aux types Qt utilisés. Sans doute pas parfait (tente régulièrement d'inclure QStringLiteral), mais mieux que rien !
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">generate-qt-includes</span> <span class="org-rainbow-delimiters-depth-2">()</span>
    <span class="org-doc">"Insert a list of Qt includes matching Qt types found in this buffer"</span>
    <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">interactive</span><span class="org-rainbow-delimiters-depth-2">)</span>
    <span class="org-rainbow-delimiters-depth-2">(</span>shell-command-on-region
     <span class="org-rainbow-delimiters-depth-3">(</span>point-min<span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-3">(</span>point-max<span class="org-rainbow-delimiters-depth-3">)</span>
     <span class="org-comment-delimiter">;; </span><span class="org-comment">Pourquoi ne peut-on pas mettre le pipe en d&#233;but de ligne ?</span>
     <span class="org-string">"sed 's/</span><span class="org-string"><span class="org-warning">\</span></span><span class="org-string">#.*include.*&lt;.*&gt;/#include &lt;header&gt;/' |</span>
<span class="org-string">sed 's://.*:// comment:' |</span>
<span class="org-string">sed -n 's/.*</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">(</span></span><span class="org-string">Q[A-Z][a-zA-Z]*</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">)</span></span><span class="org-string">.*/#include &lt;\\1&gt;/p' |</span>
<span class="org-string">sort | uniq"</span> <span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>insert-buffer <span class="org-string">"*Shell Command Output*"</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Le raccourci <kbd>M</kbd>-<kbd>#</kbd> appelle <code>generate-qt-includes</code>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"M-#"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'generate-qt-includes<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org7b72898" class="outline-2">
<h2 id="org7b72898">Rainbow delimiters</h2>
<div class="outline-text-2" id="text-org7b72898">
<p>
Met en évidence les symboles ouvrants et fermants, comme les parenthèses, les accolades ou les crochets, avec des couleurs appariées. Raffiné et élégant !
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>my-require 'rainbow-delimiters<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Exemple avec des parenthèses :
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">when</span> <span class="org-rainbow-delimiters-depth-2">(</span>foo <span class="org-rainbow-delimiters-depth-3">(</span>bar <span class="org-rainbow-delimiters-depth-4">(</span>baz t<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Active cette fonctionnalité dans tous les modes de développement
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>add-hook 'prog-mode-hook 'rainbow-delimiters-mode<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org1527435" class="outline-2">
<h2 id="org1527435">Rainbow mode</h2>
<div class="outline-text-2" id="text-org1527435">
<p>
Cherche dans un buffer les chaines représentant une couleur, et les surligne avec cette couleur. Quelquefois il devine mal et surligne des couleurs qui n'en sont pas, mais ça reste très pratique, et joli, ce qui ne gâche rien ! L'essayer c'est l'adopter.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>my-require 'rainbow-mode<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Quelques exemples de couleurs reconnues :
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>message <span class="org-string">"De la couleur ! #ffafff #F5DEB3 #def DeepPink"</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Active cette fonctionnalité dans tous les modes de développement
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>add-hook 'prog-mode-hook 'rainbow-mode<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org624f9c8" class="outline-2">
<h2 id="org624f9c8">Related</h2>
<div class="outline-text-2" id="text-org624f9c8">
<p>
Package <a href="https://github.com/julien-montmartin/related">perso</a>, disponible sur Melpa. Related simplifie les noms des buffers pour obtenir une base, et tous les buffers ayant la même base forment un groupe.
</p>

<ul class="org-ul">
<li><kbd>C</kbd>-<kbd>x</kbd> <kbd>↑</kbd> appelle <code>related-switch-forward</code> et passe au prochain buffer du groupe</li>
<li><kbd>C</kbd>-<kbd>x</kbd> <kbd>↓</kbd> appelle <code>related-switch-backward</code> et revient au précédent buffer du groupe</li>
</ul>

<p>
Related permet de naviguer facilement parmi des buffers qui vont ensemble. Par exemple si les trois fichiers suivants sont ouverts :
</p>

<ul class="org-ul">
<li><code>/path/to/include/foo.h</code></li>
<li><code>/path/to/source/foo.c</code></li>
<li><code>/path/to/doc/foo.org</code></li>
</ul>

<p>
On peut passer de l'un à l'autre avec <kbd>C</kbd>-<kbd>x</kbd> <kbd>↑</kbd> : <code>foo.h</code> → <code>foo.c</code> → <code>foo.org</code> → <code>foo.h</code> etc.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>my-require 'related<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Active Related, qui est un mode mineur global
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>related-mode<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
<kbd>C</kbd>-<kbd>x</kbd> <kbd>END</kbd> propose de choisir un buffer du groupe, en utilisant Helm, s'il est activé
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"C-x &lt;end&gt;"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'related-switch-buffer <span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb5ae57b" class="outline-2">
<h2 id="orgb5ae57b">Rust</h2>
<div class="outline-text-2" id="text-orgb5ae57b">
<p>
Rust dispose d'un très bon support dans Emacs, au travers des paquets suivants :
</p>
<ul class="org-ul">
<li><code>rust-mode</code> : mode majeur pour Rust, mise en évidence de syntaxe et c<sup>ie</sup>.</li>
<li><code>cargo</code> : raccourcis clavier pour piloter Cargo, le <i>front-end</i> à tout faire de Rust</li>
<li><code>flycheck-rust</code> : mise en évidence des erreurs au fil de la saisie</li>
<li><code>ob-rust</code> : exécution des blocs de code Rust dans Org avec Babel</li>
<li><code>racer</code> : support de Racer, outil externe d'indexation du code</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>my-require 'rust-mode<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>my-require 'cargo<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>my-require 'flycheck-rust<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>my-require 'ob-rust<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>my-require 'racer<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
On ajoute un peu de configuration pour Racer afin d'avoir les raccourcis habituels <kbd>M</kbd>-<kbd>.</kbd> et <kbd>M</kbd>-<kbd>*</kbd> pour aller à la définition d'un symbol et revenir.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>add-hook 'rust-mode-hook 'racer-mode<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>add-hook 'rust-mode-hook <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">lambda</span> <span class="org-rainbow-delimiters-depth-3">()</span> <span class="org-rainbow-delimiters-depth-3">(</span>local-set-key <span class="org-rainbow-delimiters-depth-4">(</span>kbd <span class="org-string">"M-."</span><span class="org-rainbow-delimiters-depth-4">)</span> 'racer-find-definition<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>add-hook 'rust-mode-hook <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">lambda</span> <span class="org-rainbow-delimiters-depth-3">()</span> <span class="org-rainbow-delimiters-depth-3">(</span>local-set-key <span class="org-rainbow-delimiters-depth-4">(</span>kbd <span class="org-string">"M-*"</span><span class="org-rainbow-delimiters-depth-4">)</span> 'pop-tag-mark<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
On peut également utiliser <kbd>C</kbd>-<kbd>M</kbd>-<kbd>i</kbd> pour invoquer <code>completion-at-point</code>, qui ouvre dans un buffer Helm une liste des définitions appropriées trouvées par Racer. Cette liste est plus intéressante que le menu d'Auto Complete, qui se contente des symboles, et non de leurs définitions complètes.
</p>

<p>
Racer doit évidemment être installé, configuré, et sur le PATH. On peut vérifier que son installation est fonctionnelle en lançant depuis le terminal une commande <code>racer complete</code> :
</p>

<pre class="example">
racer complete std::io::B
MATCH BufRead,1375,10,[...]/rust/src/libstd/io/mod.rs,Trait,pub trait BufRead: Read
MATCH Bytes,1995,11,[...]/rust/src/libstd/io/mod.rs,Struct,pub struct Bytes&lt;R&gt;
MATCH BufReader,56,11,[...]/rust/src/libstd/io/buffered.rs,Struct,pub struct BufReader&lt;R&gt;
MATCH BufWriter,420,11,[...]/rust/src/libstd/io/buffered.rs,Struct,pub struct BufWriter&lt;W: Write&gt;
</pre>

<p>
rust-indent-offset to equal tab-width
</p>
</div>
</div>

<div id="outline-container-orgb0cd68c" class="outline-2">
<h2 id="orgb0cd68c">Shell scripts</h2>
<div class="outline-text-2" id="text-orgb0cd68c">
<p>
Les fichiers en <code>.sh</code> s'ouvrent avec <code>shell-script-mode</code>, indépendamment de leur <i>shebang</i>. Pour une raison qui reste à déterminer, cette ligne ne fonctionne pas quand elle se trouve au début de ce fichier de configuration.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>add-to-list 'auto-mode-alist '<span class="org-rainbow-delimiters-depth-2">(</span><span class="org-string">"\\.sh\\'"</span> . sh-mode<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org3146b03" class="outline-2">
<h2 id="org3146b03">Souris</h2>
<div class="outline-text-2" id="text-org3146b03">
<p>
La molette de la souris fait défiler les lignes deux par deux
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> mouse-wheel-scroll-amount '<span class="org-rainbow-delimiters-depth-2">(</span>2<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Le défilement à l'écran suit la molette, et le pas reste constant quand elle accélère
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> mouse-wheel-progressive-speed nil<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf7fad86" class="outline-2">
<h2 id="orgf7fad86">Tcl</h2>
<div class="outline-text-2" id="text-orgf7fad86">
<p>
Ouvre les <code>.tm</code> comme des modules Tcl
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> auto-mode-alist <span class="org-rainbow-delimiters-depth-2">(</span>append '<span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span><span class="org-string">"</span><span class="org-string"><span class="org-warning">\</span></span><span class="org-string">.tm$"</span> . tcl-mode<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span> auto-mode-alist<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org63f602b" class="outline-2">
<h2 id="org63f602b">Tramp</h2>
<div class="outline-text-2" id="text-org63f602b">
<p>
Transfère les fichiers en utilisant ssh, plutôt que ftp
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> tramp-default-method <span class="org-string">"ssh"</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb9ef341" class="outline-2">
<h2 id="orgb9ef341">Unfill</h2>
<div class="outline-text-2" id="text-orgb9ef341">
<p>
La fonction <code>fill</code> permet de découper correctement les lignes trop longues, et le paquet <code>unfill</code> fournit la fonction inverse, celle qui recolle les lignes. Et même mieux, ce paquet fournit également <code>unfill-toggle</code>, qui passe d'un état à l'autre. Si simple et tellement utile ! Travaille sur la région si elle est définie, sur le paragraphe sinon.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>my-require 'unfill<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Le raccourci par défaut pour <code>fill</code> est remplacé sans états d'âme
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"M-q"</span><span class="org-rainbow-delimiters-depth-2">)</span> 'unfill-toggle<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org908a7ac" class="outline-2">
<h2 id="org908a7ac">Unicode et UTF-8</h2>
<div class="outline-text-2" id="text-org908a7ac">
<p>
<a href="https://github.com/rolandwalker/unicode-fonts">Unicode Fonts</a> améliore l'affichage de certains caractères Unicode en choisissant des correspondances entre fontes plus appropriées que l'algorithme par défaut d'Emacs. Particulièrement utile avec <a href="#orgd9dfcbf">Prettify Symbols</a> car sans ça Emacs sous Windows 10 est incapable par exemple d'afficher l'opérateur d'égalité <code>⩵</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>my-require 'unicode-fonts<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Résous les différents caractères Unicode avec les fontes les plus appropriées du système.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>unicode-fonts-setup<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Sous Windows, on ne fait surtout pas d'économie de mémoire sur le cache des fontes, sans quoi l'affichage des buffers contenant certains caractères Unicode est si lent qu'Emacs en devient inutilisable. Là encore, particulièrement utile avec <a href="#orgd9dfcbf">Prettify Symbols</a>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> inhibit-compacting-font-caches t<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Autant que possible, on veut de l'UTF-8. De nombreuses variables permettent de configurer finement les divers comportements d'Emacs en matière d'encodage (voir par exemple <a href="https://stackoverflow.com/a/2903256">cette réponse</a> sur Stack Overflow). Mais la simple directive <code>set-language-environment</code> réalise un paramétrage par défaut satisfaisant.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>set-language-environment 'utf-8<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc5bd121" class="outline-2">
<h2 id="orgc5bd121">Uniquify</h2>
<div class="outline-text-2" id="text-orgc5bd121">
<p>
Génère des libellés plus pertinents pour les buffers de mêmes noms
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>my-require 'uniquify<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Soit les fichiers <code>xxx/yyy/foo.txt</code> et <code>zzz/ttt/foo.txt</code> tous les deux ouverts dans des buffers. Plutôt que d'avoir deux buffers affichant <code>foo.txt</code>, on aura avec la méthode <code>post-forward</code> les libellés <code>foo.txt|xxx/yyy</code> et <code>foo.txt|zzz/ttt</code>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> uniquify-buffer-name-style 'post-forward<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org3098d71" class="outline-2">
<h2 id="org3098d71">Whitespace</h2>
<div class="outline-text-2" id="text-org3098d71">
<p>
Un mode mineur qui permet de visualiser les espaces, de nettoyer les lignes blanches, ou encore de visualiser les lignes trop longues. Très paramétrable.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>my-require 'whitespace<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
La variable <code>whitespace-style</code> contrôle les types d'espaces qui seront affichés. La première valeur, <code>face</code>, est particulière et active la mise en évidence des espaces en changeant leur couleur de fond. Viennent ensuite :
</p>

<ul class="org-ul">
<li><code>trailing</code>, qui met en évidence les espaces inutiles en fin de ligne</li>
<li><code>lines</code>, qui met en évidence les lignes, essentiellement vides, ne contenant que des espaces, ainsi que les lignes trop longues (voir <code>whitespace-line-column</code>)</li>
<li><code>empty</code>, qui met en évidence les lignes vides en début et fin de fichier</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> whitespace-style '<span class="org-rainbow-delimiters-depth-2">(</span>face trailing lines empty<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
<kbd>C</kbd>-<kbd>h</kbd> <kbd>o</kbd> avec le curseur sur <code>whitespace-style</code> vous emmènera vers la doc qui énumère toutes les catégories d'espaces. À noter que les espaces ne sont pas nécessairement mis en évidence en surlignant leur couleur de fond : on peut également les remplacer et afficher par exemple "›" à la place d'une tabulation.
</p>

<p>
Lorsqu'on sauvegarde un fichier, on veut que les espaces soient automatiquement remis en ordre : Suppression des lignes vides en début ou fin de fichier, des espaces qui ne servent à rien, application des politiques de tabulation vs espace, etc. Attention au diff la première fois qu'on fait ça sur un fichier.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>add-hook 'before-save-hook 'whitespace-cleanup<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<p>
Active whitespace-mode dans tous les modes de développement
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>add-hook 'prog-mode-hook 'whitespace-mode<span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org8a05bb8" class="outline-2">
<h2 id="org8a05bb8">XML</h2>
<div class="outline-text-2" id="text-org8a05bb8">
<p>
Une fonction pour remettre en forme du XML. Prise sur le site de <a href="http://blog.bookworm.at/2007/03/pretty-print-xml-with-emacs.html">Benjamin Ferrari</a>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">pretty-print-xml-region</span> <span class="org-rainbow-delimiters-depth-2">(</span>begin end<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-doc">"Pretty format XML markup in region. You need to have nxml-mode</span>
<span class="org-doc">http://www.emacswiki.org/cgi-bin/wiki/NxmlMode installed to do</span>
<span class="org-doc">this.  The function inserts linebreaks to separate tags that have</span>
<span class="org-doc">nothing but whitespace between them.  It then indents the markup</span>
<span class="org-doc">by using nxml's indentation rules."</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">interactive</span> <span class="org-string">"r"</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">save-excursion</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>nxml-mode<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>goto-char begin<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">split &lt;foo&gt;&lt;foo&gt; or &lt;/foo&gt;&lt;foo&gt;, but not &lt;foo&gt;&lt;/foo&gt;</span>
    <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">while</span> <span class="org-rainbow-delimiters-depth-4">(</span>search-forward-regexp <span class="org-string">"&gt;[ \t]*&lt;[</span><span class="org-string"><span class="org-negation-char">^</span></span><span class="org-string">/]"</span> end t<span class="org-rainbow-delimiters-depth-4">)</span>
      <span class="org-rainbow-delimiters-depth-4">(</span>backward-char 2<span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-rainbow-delimiters-depth-4">(</span>insert <span class="org-string">"\n"</span><span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-keyword">incf</span> end<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-comment-delimiter">;; </span><span class="org-comment">split &lt;foo/&gt;&lt;/foo&gt; and &lt;/foo&gt;&lt;/foo&gt;</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>goto-char begin<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">while</span> <span class="org-rainbow-delimiters-depth-4">(</span>search-forward-regexp <span class="org-string">"&lt;.*?/.*?&gt;[ \t]*&lt;"</span> end t<span class="org-rainbow-delimiters-depth-4">)</span>
      <span class="org-rainbow-delimiters-depth-4">(</span>backward-char<span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-rainbow-delimiters-depth-4">(</span>insert <span class="org-string">"\n"</span><span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-keyword">incf</span> end<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>indent-region begin end nil<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>normal-mode<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>message <span class="org-string">"All indented!"</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orge3d39e8" class="outline-2">
<h2 id="orge3d39e8">Installation automatique</h2>
<div class="outline-text-2" id="text-orge3d39e8">
<p>
Finalement, pour simplifier la configuration d'Emacs sur une nouvelle machine, la fonction my-setup installe automatiquement la plupart des paquets utilisés ici. La plupart seulement, car pour certains, il est quand même préférable de voir au cas par cas s'ils sont nécessaires. Inspiré de <a href="https://stackoverflow.com/a/10093312">cette réponse</a> sur Stack Overflow.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">my-setup</span><span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>add-to-list 'package-archives
               '<span class="org-rainbow-delimiters-depth-3">(</span><span class="org-string">"MELPA"</span> . <span class="org-string">"http://melpa.milkbox.net/packages/"</span><span class="org-rainbow-delimiters-depth-3">)</span> t<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">unless</span> package-archive-contents
    <span class="org-rainbow-delimiters-depth-3">(</span>package-refresh-contents<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">dolist</span> <span class="org-rainbow-delimiters-depth-3">(</span>package '<span class="org-rainbow-delimiters-depth-4">(</span>ac-capf
                     ac-helm
                     auto-complete-config
                     bm
                     cargo
                     cmake-mode
                     column-marker
                     epa-file
                     fill-column-indicator
                     flycheck-rust
                     fuzzy
                     ggtags
                     graphviz-dot-mode
                     helm
                     helm-projectile
                     htmlize
                     idle-highlight-mode
                     leuven
                     magit
                     mmm-mode
                     ob-rust
                     projectile
                     racer
                     rainbow-delimiters
                     rainbow-mode
                     related
                     rust-mode
                     unfill
                       unicode-fonts
                     uniquify
                     whitespace<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
      <span class="org-rainbow-delimiters-depth-3">(</span>message <span class="org-string">"---&gt; %s"</span> package<span class="org-rainbow-delimiters-depth-3">)</span>
      <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">unless</span> <span class="org-rainbow-delimiters-depth-4">(</span>package-installed-p package<span class="org-rainbow-delimiters-depth-4">)</span>
        <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-keyword">ignore-errors</span>
          <span class="org-rainbow-delimiters-depth-5">(</span>package-install package<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</pre>
</div>

<hr />

<p>
Valider les <a href="http://validator.w3.org/checklink?uri=julien-montmartin.github.io/dot-emacs">liens</a>, les <a href="http://validator.w3.org/check?uri=julien-montmartin.github.io/dot-emacs">balises</a>, ou le <a href="http://jigsaw.w3.org/css-validator/validator?uri=julien-montmartin.github.io/dot-emacs">style</a>.
</p>
</div>
</div>
</div>
</body>
</html>
